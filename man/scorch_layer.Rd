% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/scorch_layer.R
\name{scorch_layer}
\alias{scorch_layer}
\title{Add a Layer to a Scorch Model}
\usage{
scorch_layer(scorch_model, name, layer_fn, inputs = NULL, ...)
}
\arguments{
\item{scorch_model}{A \code{scorch_model} object.}

\item{name}{Unique name for this layer node in the graph.}

\item{layer_fn}{Either a string prefix (e.g. "linear"), a full string name
(e.g. "nn_linear"), an unquoted torch constructor (e.g., \code{linear}), or a
\verb{torch::nn_*} function (e.g. \code{nn_linear}).}

\item{inputs}{Character vector of upstream node names. If \code{NULL}, uses the
sole input (if no layers yet) or the last-built layer.}

\item{...}{Additional parameters passed to \code{layer_fn()} (e.g. \code{in_features},
\code{out_features}, \code{kernel_size}).}
}
\value{
The updated \code{scorch_model} with the new layer appended.
}
\description{
Append a new layer (module) to the \code{scorch_model} graph. The \code{layer_fn} can
be a string (e.g., "linear", "nn_conv2d"), an unquoted torch constructor
(e.g., \code{linear}), or a \verb{torch::nn_*} function (e.g. \code{nn_linear}).
}
\examples{

dl <- scorch_create_dataloader(mtcars$wt, mtcars$mpg, batch_size=16)

sm <- dl |>

  initiate_scorch() |>

  scorch_input("wt") |>

  scorch_layer(

    name = "h1",
    layer_fn = "linear",
    inputs = "wt",
    in_features = 1,
    out_features = 8
  )

print(sm)

}
