% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit_scorch.R
\name{fit_scorch}
\alias{fit_scorch}
\title{Fit a Scorch Model}
\usage{
fit_scorch(
  sm,
  num_epochs = 10,
  verbose = TRUE,
  preprocess_fn = NULL,
  clip_grad = NULL,
  clip_params = list(),
  ...
)
}
\arguments{
\item{sm}{A compiled \code{scorch_model} (output of \link{compile_scorch}).}

\item{num_epochs}{Integer number of training epochs.}

\item{verbose}{Logical; if \code{TRUE}, prints additional training details.}

\item{preprocess_fn}{Optional function to transform batches before training.}

\item{clip_grad}{One of \code{"norm"}, \code{"value"}, or \code{NULL} for gradient clipping.}

\item{clip_params}{Named list of clipping parameters
(\code{max_norm} or \code{clip_value}).}

\item{...}{Additional arguments passed to the \code{preprocess_fn}, if provided.}
}
\value{
The trained \code{scorch_model} with updated \code{nn_model} weights.
}
\description{
Train a compiled scorch model for a given number of epochs. Supports either
a single loss function (single-output) or a named list of loss functions
(multi-head).
}
\examples{

dl <- scorch_create_dataloader(mtcars$wt, mtcars$mpg, batch_size = 16)

sm <- dl |>

  initiate_scorch() |>

  scorch_input("wt") |>

  scorch_layer("h1", "linear", in_features = 1, out_features = 8) |>

  scorch_output("h1") |>

  compile_scorch()

sm <- fit_scorch(sm, num_epochs = 2, verbose = FALSE)

print(sm)

}
